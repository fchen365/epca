---
title: "Vignette"
author: "Fan Chen"
date: "9/17/2019"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to epca package}
  %\VignetteEngin{knitr:rmarkdown}
  \usepackage[utf8](inputenc)
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(epca)
library(tidyverse)
```

## Example

First, generate a matrix with rank-5 sparse component (i.e., $Z$ and $Y$)
```{r cars}
K = 5
n = 60
p = 50
S = runif(n * K) %>% matrix(n, K)
Y = runif(p * K) %>% matrix(p, K) %>% polar %>% soft(constraint = 2 * K)
Y = Y$matrix
d = rep(1, K)
A = S %*% diag(d) %*% t(Y) + matrix(rnorm(n * p, sd = .02), n, p)
A = scale(A, center = T, scale = F) ## WLOG assume A is centered by col

s.smd <- smd(A, k = 5, lambda = 2*K, side = "right")
```


